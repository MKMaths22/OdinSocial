<% content_for :head do %>
  <meta name="turbo-visit-control" content="reload" >
<% end %>
<% if current_user == @user %>  
  <turbo-frame id="edit_account">
    <div class="accountinfodiv">
      <div class="namediv">
        Name: 
        <%= @user.name %>
      </div>
      <div class="emaildiv">
        Email: 
        <%= @user.email %>
      </div>
      <%= link_to "Edit My Account", edit_user_registration_path %>
    </div>
  </turbo-frame>
<% else %>
  You are not authorised to see/edit this user's account information.
<% end %>

<turbo-frame id="edit_profile">
  <div class="profilediv">
    <h3>About 
      <% if current_user == @user %>
        Me
      <% else %>
        <%= @user.name %>
      <% end %>
    </h3>
    <div class="profilebody">
      <%= @profile.body %>
    </div>
    
    <div class="profilefield">
      <% if @profile.field_name_one.strip.size.positive? %>
        <div class="profilefieldname">
          <%= @profile.field_name_one %>
        </div>
        <div class="profilefieldcontent">
          <%= @profile.field_content_one %>
        </div>
      <% end %>
    </div>
    <div class="profilefield">
    <% if @profile.field_name_two.strip.size.positive? %>
      <div class="profilefieldname">
        <%= @profile.field_name_two %>
      </div>
      <div class="profilefieldcontent">
        <%= @profile.field_content_two %>
      </div>
    <% end %>
    </div>
    <div class="profilefield">
      <% if @profile.field_name_three.strip.size.positive? %>
        <div class="profilefieldname">
          <%= @profile.field_name_three %>
        </div>
        <div class="profilefieldcontent">
          <%= @profile.field_content_three %>
        </div>
      <% end %>
    </div>
    <% if current_user == @user %>
      <%= link_to "Edit Profile Info.", edit_profile_path(id: @profile.id) %>
    <% else %>
      You are not authorised to edit this user's profile information.
    <% end %>
  
    <%= image_tag(@profile.picture, width: 200) if @profile.picture.attached? %>
  </div>
</turbo-frame>

<% if current_user == @user %>
  <% title = "My Recent posts" %>
<% else %>
  <% title = "Recent posts by #{@user.name}" %>
<% end %>

<%= render 'posts/display_many_posts', posts_collection: @user_posts, header_text: title %>